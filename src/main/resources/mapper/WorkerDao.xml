<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.WorkerDao">
    <select id="selectAuthorityByUsername" resultType="String" parameterType="String">
        select authority from worker where username = #{username}
    </select>
    <select id="selectWorkerByUsername" resultType="com.example.demo.domain.Worker">
        select * from worker where username = #{username}
    </select>

    <update id="updateIsOnline">
        update worker set is_online = "1" where username = #{username}
    </update>

    <update id="updatePassword">
        update worker set password = #{password} where username = #{username}
    </update>
    <!--工作人员离线-->
    <update id="updateIsOffline">
        update worker set is_online = "0" where username = #{username}
    </update>
    <!--检测登录状态-->
    <select id="workerIsOnline" resultType="String">
        select is_online from worker where username = #{loginUsername}
    </select>

    <!--为咨询师绑定督导-->
    <select id="findAllCounselor" resultType="com.example.demo.domain.Bind">
        select name, username from worker where authority = "Counselor" and bind_username = null
    </select>
    <select id="findAllSupervisor" resultType="com.example.demo.domain.Bind">
        select name, username from worker where authority = "Supervisor"
    </select>
    <insert id="insertBind" parameterType="String">
        insert into worker(bind_name, bind_username) values (#{supervisorName}, #{supervisorUsername}) where username = #{counselorName} and name = #{counselorName}
    </insert>
</mapper>